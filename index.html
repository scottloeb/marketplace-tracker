<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Marketplace Tracker</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .listing { border: 1px solid #ccc; margin: 10px 0; padding: 15px; }
        .pending { background-color: #fff3cd; }
        button { padding: 10px 15px; margin: 5px; cursor: pointer; }
        input, textarea { width: 100%; padding: 8px; margin: 5px 0; }
    </style>
</head>
<body>
    <h1>Marketplace Tracker</h1>
    
    <div id="addForm">
        <h3>Add Listing</h3>
        <input type="text" id="urlInput" placeholder="Facebook URL">
        <button onclick="addListing()">Add Listing</button>
    </div>
    
    <div id="listings"></div>
    
    <div>
        <button onclick="exportListings()">Export Listings</button>
        <button onclick="importListings()">Import Enhanced Data</button>
    </div>

    <script>
        let listings = JSON.parse(localStorage.getItem('tracker-listings') || '[]');
        
        function displayListings() {
            const container = document.getElementById('listings');
            container.innerHTML = listings.map((listing, index) => `
                <div class="listing ${listing.status || 'pending'}">
                    <strong>${listing.title || 'Untitled Listing'}</strong><br>
                    Price: $${listing.price || 0}<br>
                    Location: ${listing.location || 'No location'}<br>
                    Status: ${listing.status || 'pending'}<br>
                    URL: <a href="${listing.url}" target="_blank">View</a><br>
                    <button onclick="editListing(${index})">Edit</button>
                    <button onclick="deleteListing(${index})">Delete</button>
                </div>
            `).join('');
        }
        
        function addListing() {
            const url = document.getElementById('urlInput').value;
            if (!url) return;
            
            listings.push({
                id: Date.now(),
                url: url,
                title: '',
                price: 0,
                status: 'pending',
                dateAdded: new Date().toISOString()
            });
            
            saveListings();
            displayListings();
            document.getElementById('urlInput').value = '';
        }
        
        function saveListings() {
            localStorage.setItem('tracker-listings', JSON.stringify(listings));
        }
        
        function exportListings() {
            const pendingListings = listings.filter(l => l.status === 'pending' || l.price === 0);
            console.log('Pending listings for enhancement:');
            console.log(JSON.stringify(pendingListings, null, 2));
            alert('Check console for exportable JSON data');
        }
        
        function importListings() {
            const data = prompt('Paste enhanced JSON data:');
            if (data) {
                try {
                    const parsed = JSON.parse(data);
                    if (parsed.data) {
                        listings = parsed.data;
                    } else {
                        listings = parsed;
                    }
                    saveListings();
                    displayListings();
                    alert('Data imported successfully');
                } catch(e) {
                    alert('Invalid JSON data');
                }
            }
        }
        
        function deleteListing(index) {
            listings.splice(index, 1);
            saveListings();
            displayListings();
        }
        
        function editListing(index) {
            const listing = listings[index];
            const title = prompt('Title:', listing.title);
            const price = prompt('Price:', listing.price);
            const location = prompt('Location:', listing.location);
            
            if (title !== null) listing.title = title;
            if (price !== null) listing.price = parseFloat(price) || 0;
            if (location !== null) listing.location = location;
            
            saveListings();
            displayListings();
        }
        
        // Initialize
        displayListings();
        
        // Make listings globally available for console access
        window.listings = listings;
        window.exportListings = exportListings;
    </script>
</body>
</html>
